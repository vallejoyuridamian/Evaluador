unit uevaluadormatches;

{$mode delphi}

interface

uses
  Classes, SysUtils,uopencalc;

procedure evaluar;
function getPartidos():TStringList;
procedure tratarArchivo(archi:string);

implementation

procedure evaluar;
var
  nombres:TStringList;
  kNombre:Integer;
begin

  nombres:=getPartidos();

  for kNombre:=0 to nombres.Count - 1 do
  begin
    tratarArchivo(GetCurrentDir+DirectorySeparator+nombres[kNombre]);
    writeln(GetCurrentDir+DirectorySeparator+nombres[kNombre]);
  end;


  FreeAndNil(nombres);
  readln();


end;

function getPartidos: TStringList;
var
  nombres:TStringList;
  busqueda:string;
  archivos: TSearchRec;
  res:integer;
begin
  nombres:=TStringList.Create;
  chdir('partidos_raw');
  busqueda:=GetCurrentDir+DirectorySeparator+'*.xlsx';
  res:=FindFirst(busqueda,faAnyFile,archivos);
  if res = 0 then
    nombres.Add(archivos.Name);
  while FindNext(archivos) = 0 do
    nombres.Add(archivos.Name);
  FindClose(archivos);
  Result:=nombres;
end;

procedure tratarArchivo(archi: string);
var
  xlsx:TLibro
begin

end;

end.

